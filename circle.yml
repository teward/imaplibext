machine:
  post:
    - pyenv global 2.7.10
dependencies:
  cache_directories:
    - "~/virtualenvs"
    - "~/.cache/pip"
  pre:
    - if [ $CIRCLE_NODE_INDEX == "1" ] ; then pyenv global 3.6.1 ; fi
  post:
    - if [ $CIRCLE_NODE_INDEX == "0" ] ; then pip install flake8 --upgrade ; fi
    - if [ $CIRCLE_NODE_INDEX == "0" ] ; then pip install -r requirements.txt --upgrade ; fi
    - if [ $CIRCLE_NODE_INDEX == "1" ] ; then pip3 install flake8 --upgrade
    - if [ $CIRCLE_NODE_INDEX == "1" ] ; then pip3 install -r requirements.txt --upgrade
test:
  override:
    - flake8 .
    - if [ $CIRCLE_NODE_INDEX == "0" ] ; then python -m unittest -v tests ; fi
    - if [ $CIRCLE_NODE_INDEX == "1" ] ; then python3 -m unittest -v tests ; fi